General-purpose utility functions and helpers